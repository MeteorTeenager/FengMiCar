<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.qfedu.bus.mapper.CustomerMapper">

    <!--定义resultMap-->
    <resultMap id="base_result_data" type="com.qfedu.bus.domain.Customer">
        <!--数据库表字段和domian中user字段的对应关系-->
        <id column="identity" jdbcType="VARCHAR" property="identity" />
        <result column="custname" jdbcType="VARCHAR" property="custname" />
        <result column="sex" jdbcType="DOUBLE" property="sex" />
        <result column="address" jdbcType="VARCHAR" property="address" />
        <result column="phone" jdbcType="VARCHAR" property="phone" />
        <result column="career" jdbcType="VARCHAR" property="career" />
        <result column="createtime" jdbcType="TIMESTAMP" property="createtime" />

    </resultMap>

    <sql id="customer_column_list">
        identity, custname, sex, address, phone, career, createtime
    </sql>

      <!--
       用户带条件的全查询
      -->
    <select id="queryAllCustomer" resultMap="base_result_data">
        select <include refid="customer_column_list"/> from  bus_customer
        <where>
            <if test="identity != null and identity !=''">
                and identity like concat("%",#{identity},"%")
            </if>
            <if test="custname != null and custname !=''">
                and custname like concat("%",#{custname},"%")
            </if>
            <if test="address != null and address !=''">
                and address like concat("%",#{address},"%")
            </if>
            <if test="career != null and career !=''">
                and career like concat("%",#{career},"%")
            </if>
            <if test="phone != null and phone !=''">
                and phone like concat("%",#{phone},"%")
            </if>
            <if test="sex != null">
                and sex = #{sex}
            </if>
        </where>
            order by createtime desc
    </select>

    
    <!--添加客户-->
    <insert id="insertSelect">
        insert into bus_customer
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="identity != null">
                identity,
            </if>
            <if test="custname != null">
                custname,
            </if>
            <if test="sex != null">
                sex,
            </if>
            <if test="address != null">
                address,
            </if>
            <if test="phone != null">
                phone,
            </if>
            <if test="career != null">
                career,
            </if>
            <if test="createtime != null">
                createtime,
            </if>
          </trim>

         <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="identity != null">
                #{identity},
            </if>
            <if test="custname != null">
                #{custname},
            </if>
            <if test="sex != null">
                #{sex},
            </if>
            <if test="address != null">
                #{address},
            </if>
            <if test="phone != null">
                #{phone},
            </if>
            <if test="career != null">
                #{career},
            </if>
            <if test="createtime != null">
                #{createtime},
            </if>
        </trim>
    </insert>
    
    <!--删除客户信息-->
    <delete id="deleteCustomerById">
        delete from bus_customer where identity = #{identity}
    </delete>


    <!--更新客户的方法-->
    <update id="updateCustomer">
        update bus_customer
        <set>
            <if test="custname != null">
                custname = #{custname},
            </if>
            <if test="sex != null">
                sex = #{sex},
            </if>
            <if test="address != null">
                address = #{address},
            </if>
            <if test="phone != null">
                phone = #{phone},
            </if>
            <if test="career != null">
                career = #{career},
            </if>
        </set>
            where identity = #{identity}
    </update>


<!--      Customer findCustomerById(String identity);  -->
    <select id="findCustomerById" resultMap="base_result_data">
        select <include refid="customer_column_list"/> from bus_customer
        where identity = #{identity }
    </select>
</mapper>